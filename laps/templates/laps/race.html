{% include "laps/header.html" %}

{% load lap_extras %}

<ol class="breadcrumb">
  <li><a href="#">home</a></li>
  <li><a href="{% url 'laps:races' %}">races</a></li>
  <li class="active">{{ race.name }}</li>
</ol>

<h1>
	<span class="glyphicon glyphicon-flag" aria-hidden="true"></span>
	{{ race.name }} with {{ race.organization }}
</h1>
<div class="row">
	<div class="col-md-11 col-md-offset-1">
	<h3>{{ race.date }}</h3>
	<h3>
		<span class="glyphicon glyphicon-road" aria-hidden="true"></span>
		<a href="{% url 'laps:track' race.track.id %}">{{ race.track.name }}</a>
	</h3>
	{% if race.conditions %}
		<p class="text-warning">Conditions: {{ race.conditions }}</p>
	{% endif %}
	</div>
</div>
<!-- TODO: Conditions -->
<div class="row">
	<div class="col-md-6">
		<div class="panel panel-default">
			<div class="panel-heading">Laps</div>
			<table class="table table-striped table-hover">
			{% for lap in race.laps.all %}
				{% if race.best_lap_time == lap.time %}
					<tr class="success">
				{% else %}
					<tr>
				{% endif %}
					<td>{{ lap.num }}</td>
			    	<td>{{ lap.time|format_lap_time }}</td>
			    </tr>
			{% endfor %}
			</table>
		</div>
	</div>
	<div class="col-md-6">
		<div class="panel panel-default">
			<div class="panel-heading">
				<span class="glyphicon glyphicon-cog" aria-hidden="true"></span>
				Configuration
			</div>
			<table class="table">
			{% for attr in race.machine_config.attributes.values %}
				<tr>
					<td><strong>{{ attr.key }}</strong></td>
					<td>{{ attr.value }}</td>
				</tr>
			{% endfor %}
			</table>
		</div>
	</div>
</div>

{% include "laps/footer.html" %}